menuconfig POWER_FOC
  bool "FOC (Field Oriented Controller) driver support"
  select LIBDSP
  default n
  ---help---
    Enables building of the "upper-half" FOC driver.

if POWER_FOC

# Support for different computations options
# We support float32 and fixed16 numeric types for now

config POWER_FOC_USE_FLOAT
       bool "FOC float support"
       default n
       ---help---
         Enables float computations support for the FOC driver.
         This is the prefered option for chips with FPU support.

config POWER_FOC_USE_FIXED16
       bool "FOC fixed16 support"
       select POWER_FOC_HAVE_FIXED
       default n
       ---help---
         Enables fixed computations support for the FOC driver.
         This is the prefered option for chips without FPU support.

config POWER_FOC_HAVE_FIXED
       bool
       default n

config POWER_FOC_FIXED16_INST
       int "FOC fixed16 instances"
       depends on POWER_FOC_USE_FIXED16
       default 1

config POWER_FOC_FLOAT_INST
       int "FOC float instances"
       depends on POWER_FOC_USE_FLOAT
       default 1

config POWER_FOC_HAVE_CORDIC
       bool "FOC lower-half CORDIC support"
       default n
       ---help---
         Enables CORDIC support in the FOC driver. This option allows the use
         of hardware acceleration for some calculations in the control algorithm.

config POWER_FOC_PHASES
       int "FOC phases number"
       default 3

config POWER_FOC_SHUNTS
       int "FOC number of shunts"
       range 1 3
       default 3
       ---help---
         Number of shunt supported (or other types of current sensors).
         Note that the upper-half logic always expect a current in a 3-phase format.
         Any current recontruction must be done on the lower-half side.

# configuration specific for FOC controller
# At the moment we support the most classic version of FOC, where
# current control is done with the PI regulator and modulation with 3-phase SVM

config POWER_FOC_CONTROL_PI
       bool "FOC default PI current controller"
       default y

config POWER_FOC_MODULATION_SVM3
       bool "FOC default 3-phase space vector modulation"
       default y

config POWER_FOC_TRACE
       bool "FOC trace support"
       default n
       ---help---
         Enables FOC driver trace interface. 

endif #POWER_FOC
